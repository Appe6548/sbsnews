<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>阳光纪录片2 - MMC News</title>
  <link rel="stylesheet" href="/css/apple-style.css?v=20260207-6">
</head>
<body>
  <nav>
    <div class="nav-container">
      <a href="/" class="brand">MMC News</a>
      <ul class="nav-items">
        <li><a href="/news.html">新闻</a></li>
        <li><a href="/archive.html">往期内容</a></li>
            <li><a href="/novel.html">小说</a></li>
        <li><a href="/about.html">关于我们</a></li>
        <li class="theme-toggle">
          <button class="theme-toggle-button" type="button" aria-label="主题切换"></button>
          <div class="theme-menu">
            <div class="theme-option" data-theme="light">
              <span class="theme-icon" aria-hidden="true"></span>
              <span>浅色模式</span>
            </div>
            <div class="theme-option" data-theme="dark">
              <span class="theme-icon" aria-hidden="true"></span>
              <span>深色模式</span>
            </div>
            <div class="theme-option active" data-theme="system">
              <span class="theme-icon" aria-hidden="true"></span>
              <span>跟随系统</span>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </nav>

  <main class="main-content">
    <div class="video-info">
      <h1 class="video-title">阳光纪录片2</h1>
      <div class="video-meta">
        <span>发布于：2024年2月26日</span>
        <span style="margin-left: 16px;">时长：2:47</span>
      </div>
      <div class="video-description">
        <div class="description-content collapsed">解俊欣指导作品，MMC News年作「阳光纪录片2」首映开场。

嘘，正片现在开演。

同时我们也为您准备了南昌语版本，你可以在视频播放器窗口进行切换</div>
        <span class="toggle-button expand">展开</span>
        <span class="toggle-button collapse" style="display: none;">收起</span>
      </div>
    </div>

    <div class="video-container">
      <video id="video" controls></video>
      <button class="language-switch">切换至南昌话</button>
    </div>
  </main>

  <footer>
    <div class="footer-content">
      <p class="footer-text"><a href="https://icp.gov.moe/?keyword=20250941" target="_blank">萌ICP备20250941号</a></p>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const video = document.getElementById('video');
      const videoContainer = document.querySelector('.video-container');
      const languageSwitch = document.querySelector('.language-switch');

      const videoSources = {
        english: 'https://r2.oai.works/%E9%98%B3%E5%85%89%E7%BA%AA%E5%BD%95%E7%89%872-%E8%8B%B1%E6%96%87-%E4%B8%AD%E8%8B%B1%E5%8F%8C%E8%AF%AD%E5%AD%97%E5%B9%95-last.mp4',
        nanchang: 'https://r2.oai.works/%E9%98%B3%E5%85%89%E7%BA%AA%E5%BD%95%E7%89%872-%E5%8D%97%E6%98%8C%E8%AF%9D-%E4%B8%AD%E8%8B%B1%E5%8F%8C%E8%AF%AD%E5%AD%97%E5%B9%95-last.MOV'
      };

      let currentLanguage = 'english';
      let currentTime = 0;
      let isPlaying = false;

      // 监听视频播放状态
      video.addEventListener('play', () => {
        videoContainer.classList.add('playing');
      });

      video.addEventListener('pause', () => {
        videoContainer.classList.remove('playing');
      });

      // 监听鼠标移动
      let timeout;
      videoContainer.addEventListener('mousemove', () => {
        languageSwitch.style.opacity = '1';
        clearTimeout(timeout);

        if (video.played.length > 0 && !video.paused) {
          timeout = setTimeout(() => {
            languageSwitch.style.opacity = '0';
          }, 2500); // 2.5秒后隐藏
        }
      });

      videoContainer.addEventListener('mouseleave', () => {
        if (video.played.length > 0 && !video.paused) {
          languageSwitch.style.opacity = '0';
        }
      });

      function loadVideo(src) {
        video.src = src;
        video.load();
      }

      // 初始加载英语版本
      loadVideo(videoSources.english);

      languageSwitch.addEventListener('click', () => {
        // 保存当前播放状态和时间
        currentTime = video.currentTime;
        isPlaying = !video.paused;

        if (currentLanguage === 'english') {
          currentLanguage = 'nanchang';
          languageSwitch.textContent = '切换至英语';
          loadVideo(videoSources.nanchang);
        } else {
          currentLanguage = 'english';
          languageSwitch.textContent = '切换至南昌话';
          loadVideo(videoSources.english);
        }

        // 视频加载完成后恢复播放状态和时间
        video.addEventListener('loadedmetadata', function onLoaded() {
          video.currentTime = currentTime;
          if (isPlaying) video.play();
          video.removeEventListener('loadedmetadata', onLoaded);
        });
      });

      // 简介展开/收起功能
      const content = document.querySelector('.description-content');
      const expandBtn = document.querySelector('.toggle-button.expand');
      const collapseBtn = document.querySelector('.toggle-button.collapse');

      // 检查内容是否需要展开按钮
      function checkOverflow() {
        const isOverflowing = content.scrollHeight > 24;
        expandBtn.style.display = isOverflowing && content.classList.contains('collapsed') ? 'inline-block' : 'none';
      }

      // 展开内容
      expandBtn.addEventListener('click', () => {
        content.classList.remove('collapsed');
        expandBtn.style.display = 'none';
        collapseBtn.style.display = 'block';
      });

      // 收起内容
      collapseBtn.addEventListener('click', () => {
        content.classList.add('collapsed');
        collapseBtn.style.display = 'none';
        expandBtn.style.display = 'inline-block';
      });

      // 页面加载后检查是否需要展开按钮
      window.addEventListener('load', checkOverflow);
      // 窗口大小改变时重新检查
      window.addEventListener('resize', checkOverflow);
    });
  </script>

  <script src="/js/apple-theme.js?v=20260207-6"></script>
</body>
</html>
